{% extends "base.html" %}

{% block title %}Каталог — {{ block.super }}{% endblock %}

{% block content %}
<div class="section">
  <h1 class="page-title">Каталог</h1>
  <p class="muted">Выберите категорию или воспользуйтесь поиском по названию товара.</p>
</div>

<form method="get" class="card catalog-toolbar">
  <div class="toolbar">
    <select name="category" onchange="this.form.submit()">
      <option value="">Все категории</option>
      {% for c in categories %}
        <option value="{{ c.slug }}" {% if curr_category == c.slug %}selected{% endif %}>{{ c.name }}</option>
      {% endfor %}
    </select>
    <input type="text" name="q" value="{{ q }}" placeholder="Поиск по названию">
    <button type="submit" class="button button--primary">Найти</button>
  </div>
</form>

{% if object_list %}
  <div class="catalog-grid">
    {% for p in object_list %}
      <article class="card product-card">
        <a href="{{ p.get_absolute_url }}">
          {% if p.image %}
            <img src="{{ p.image.url }}" alt="{{ p.title }}" class="product-card__image">
          {% else %}
            <img src="/media/products/product_placeholder.svg" alt="{{ p.title }}" class="product-card__image">
          {% endif %}
        </a>
        <div class="product-card__meta">
          <a href="{{ p.get_absolute_url }}" class="product-card__title">{{ p.title }}</a>
          <span class="muted">{{ p.category.name }}</span>
          <span class="product-card__price">{{ p.price }} мон.</span>
        </div>
      </article>
    {% endfor %}
  </div>
{% else %}
  {% include "_includes/_empty_state.html" with text="Товаров пока нет." %}
{% endif %}

{% include "_includes/_pagination.html" %}
{% endblock %}
